<apex:page id="batchJobSubmitPage" controller="BatchJobSubmitController">   
    <div id="submitBatchPage">
        <apex:form id="batchJobSubmitForm" styleClass="fs-data-form slds-form--horizontal slds-m-bottom--small">

            <apex:outputPanel id="messagePanel" styleClass="fs-message-panel">
                <apex:pagemessages showDetail="true"/>
            </apex:outputPanel>          

            <apex:actionStatus id="waitStatus">
                <apex:facet name="start">
                    <c:fsSpinner spinnerSize="medium"/>
                </apex:facet>
            </apex:actionStatus>

            <apex:outputPanel id="infoMessagePanel">
                <apex:outputPanel rendered="{!NOT(mIsBatchJobOrGroupSelected)}">
                <div align="left" class="slds-m-bottom--small">
                    <c:pageMessage messageTitle="{!$Label.fscore__batch_job_submit_screen_info_message}"
                                   rendered="{!NOT(mIsBatchJobOrGroupSelected)}" backgroundTheme="info"
                                   iconType="assets/icons/utility-sprite/svg/symbols.svg#info"/>
                </div>
                </apex:outputPanel>
            </apex:outputPanel>          

            <div class="slds-box slds-box--x-small slds-theme--default slds-container--fluid">
                <apex:pageBlock id="blkSubmitBatchJob" mode="maindetail" html-class="fs-data-block">
                    <apex:outputPanel id="selectBatchJobPanel" rendered="{!NOT(mIsBatchJobOrGroupSelected)}">
                        <c:sectionHeader label="{!mSectionTitle}"
                                         isEditSectionHeader="true" isModalWindow="true"/>
        
                        <div class="slds-grid slds-wrap slds-container--fluid slds-container--left">
                            <div id="iSubmitOptionField" class="slds-col slds-col--padded slds-align-top slds-form-element 
                                     slds-large-size--1-of-1 slds-medium-size--1-of-1 slds-small-size--1-of-1 
                                     slds-is-required" >
                                         
                                <label for="iSelectOption" class="slds-form-element__label">
                                    <strong>{!$Label.Select_An_Option_Title}</strong>
                                </label>
                                
                                <div class="slds-form-element__control">
                                    <apex:selectRadio id="iSelectOption" value="{!mSelectedOption}">
                                        <apex:selectOptions value="{!mOptionList}" />
                                        <apex:actionSupport event="onchange" action="{!onOptionSelect}" status="waitStatus"
                                                            reRender="messagePanel,infoMessagePanel,blkSubmitBatchJob"/>                
                                    </apex:selectRadio>
                                </div>
                            </div>

                            <div id="iBatchJobField" class="slds-col slds-col--padded slds-align-top slds-form-element 
                                     slds-large-size--1-of-1 slds-medium-size--1-of-1 slds-small-size--1-of-1 
                                     slds-is-required" >
                                         
                                <label for="iBatchJobName" class="slds-form-element__label">
                                    <strong>{!IF(mSelectedOption == 'JOB_GROUP',$Label.Batch_Job_Group_Select_Title,$Label.Batch_Job_Select_Title)}</strong>
                                </label>
                                
                                <div class="slds-form-element__control">
                                    <apex:outputPanel rendered="{!(mSelectedOption == 'BATCH_JOB')}">
                                        <apex:selectList id="iBatchJobName" value="{!mSelectedBatchJobDevName}" multiselect="false" size="1"
                                                         style="width: auto !important;">
                                            <apex:selectOptions value="{!mBatchJobList}" />
                                            <apex:actionSupport event="onchange" action="{!onBatchJobSelect}" status="waitStatus"
                                                                reRender="messagePanel,infoMessagePanel,blkSubmitBatchJob"/>                
                                        </apex:selectList>
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!(mSelectedOption == 'JOB_GROUP')}">
                                        <apex:selectList id="iBatchJobGroupName" value="{!mSelectedBatchJobGroupId}" multiselect="false" size="1"
                                                         style="width: auto !important;">
                                            <apex:selectOptions value="{!mBatchJobGroupList}" />
                                            <apex:actionSupport event="onchange" action="{!onBatchJobGroupSelect}" status="waitStatus"
                                                                reRender="messagePanel,infoMessagePanel,blkSubmitBatchJob"/>                
                                        </apex:selectList>
                                    </apex:outputPanel>
                                </div>
                            </div>

                        </div>
                    </apex:outputPanel>

                    <apex:outputPanel id="batchJobDetailPanel" rendered="{!AND(mSelectedOption == 'BATCH_JOB',mIsBatchJobOrGroupSelected)}">
                        <div>
                            <c:sectionHeader label="{!$Label.fscore__batch_job_select_option_title}"
                                             isEditSectionHeader="true" isModalWindow="true"/>

                            <apex:pageBlockSection columns="2" collapsible="false" >
                                
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="{!$Label.fscore__batch_job_name_title}"></apex:outputLabel>
                                    <apex:outputText value="{!mBatchJob.batchJobName}"></apex:outputText>
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="{!$Label.fscore__batch_job_class_name_title}"></apex:outputLabel>
                                    <apex:outputText value="{!mBatchJob.batchJobClassName}"></apex:outputText>
                                </apex:pageBlockSectionItem>
                            
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="{!$Label.fscore__batch_job_type_title}"></apex:outputLabel>
                                    <apex:outputText value="{!mBatchJob.batchJobType}"></apex:outputText>
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="{!$Label.fscore__batch_job_namespace_title}"></apex:outputLabel>
                                    <apex:outputText value="{!mBatchJob.namespacePrefix}"></apex:outputText>
                                </apex:pageBlockSectionItem>

                               <apex:pageBlockSectionItem rendered="{!AND(mBatchJob.branchSelectionAllowedFlag, NOT(mIsBatchJobSubmitted))}">
                                    <apex:outputLabel value="{!$ObjectType.Branch_Setup__c.Fields.Name.Label}">
                                        <apex:outputPanel rendered="{!mBatchJob.branchMandatoryFlag}" 
                                                          styleClass="fs-required slds-m-left--xxx-small">*</apex:outputPanel>
                                    </apex:outputLabel>
                                    <apex:outputPanel>
                                        <apex:selectList value="{!mSelectedBranch}" multiselect="false" size="1">
                                            <apex:selectOptions value="{!mBranchSelectList}"/>
                                        </apex:selectList>
                                        <p class="slds-text-body_small slds-text-color_weak">{!$Label.fscore__batch_job_select_branch_help_text}"</p>
                                    </apex:outputPanel
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem rendered="{!NOT(mIsBatchJobSubmitted)}">
                                    <apex:outputLabel value="{!$Label.fscore__batch_job_batch_size_title}"></apex:outputLabel>
                                    <apex:inputText value="{!mBatchSize}"></apex:inputText>
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem rendered="{!NOT(mIsBatchJobSubmitted)}">
                                    <apex:outputLabel value="{!$Label.fscore__batch_job_error_threshold_title}"></apex:outputLabel>
                                    <apex:inputText value="{!mErrorThreshold}"></apex:inputText>
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem rendered="{!AND(mBatchJob.branchSelectionAllowedFlag, mIsBatchJobSubmitted)}">
                                    <apex:outputLabel value="{!$ObjectType.Branch_Setup__c.Fields.Name.Label}"></apex:outputLabel>
                                    <apex:outputText value="{!mSelectedBranch}"></apex:outputText>
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem rendered="{!mIsBatchJobSubmitted}">
                                    <apex:outputLabel value="{!$Label.fscore__batch_job_batch_size_title}"></apex:outputLabel>
                                    <apex:outputText value="{!mBatchSize}"></apex:outputText>
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem rendered="{!mIsBatchJobSubmitted}">
                                    <apex:outputLabel value="{!$Label.fscore__batch_job_error_threshold_title}"></apex:outputLabel>
                                    <apex:outputText value="{!mErrorThreshold}"></apex:outputText>
                                </apex:pageBlockSectionItem>

                            </apex:pageBlockSection>
                        </div>
                    </apex:outputPanel>

                    <apex:outputPanel id="batchJobGroupDetailPanel" rendered="{!AND(mSelectedOption == 'JOB_GROUP',mIsBatchJobOrGroupSelected)}">
                        <div>
                            <c:sectionHeader label="{!$Label.fscore__batch_job_group_select_option_title}"
                                             isEditSectionHeader="true" isModalWindow="true"/>

                            <apex:pageBlockSection columns="1" collapsible="false" >
                                
                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="{!$ObjectType.Batch_Job_Group_Setup__c.Fields.Name.Label}"></apex:outputLabel>
                                    <apex:outputText value="{!mBatchJobGroup.Name}"></apex:outputText>
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem >
                                    <apex:outputLabel value="{!$Label.fscore__batch_job_page_title}"></apex:outputLabel>
                                    <apex:outputpanel >
                                        <apex:dataTable id="groupJobListTable" value="{!mGroupJobList}" var="groupJob"
                                                        styleClass="slds-table slds-table--bordered slds-table--compact">
                                            <apex:column > 
                                                <apex:facet name="header">
                                                    <span class="slds-text-heading--x-small slds-truncate">
                                                        <strong>{!$ObjectType.Batch_Job_Execution_Setup__c.Fields.Execution_Order__c.Label}</strong>
                                                    </span>
                                                </apex:facet>
                                                <apex:outputField value="{!groupJob.Execution_Order__c}"/>
                                            </apex:column> 
                                            <apex:column > 
                                                <apex:facet name="header">
                                                    <span class="slds-text-heading--x-small slds-truncate">
                                                        <strong>{!$ObjectType.Batch_Job_Execution_Setup__c.Fields.Batch_Job_Name__c.Label}</strong>
                                                    </span>
                                                </apex:facet>
                                                <apex:outputField value="{!groupJob.Batch_Job_Name__c}"/>
                                            </apex:column> 
                                            <apex:column > 
                                                <apex:facet name="header">
                                                    <span class="slds-text-heading--x-small slds-truncate">
                                                        <strong>{!$ObjectType.Batch_Job_Execution_Setup__c.Fields.Execution_Criteria__c.Label}</strong>
                                                    </span>
                                                </apex:facet>
                                                <apex:outputField value="{!groupJob.Execution_Criteria__c}"/>
                                            </apex:column> 
                                            <apex:column > 
                                                <apex:facet name="header">
                                                    <span class="slds-text-heading--x-small slds-truncate">
                                                        <strong>{!$ObjectType.Batch_Job_Execution_Setup__c.Fields.Parent_Batch_Job_Name__c.Label}</strong>
                                                    </span>
                                                </apex:facet>
                                                <apex:outputField value="{!groupJob.Parent_Batch_Job_Name__c}"/>
                                            </apex:column> 
                                        </apex:dataTable>
                                    </apex:outputpanel>
                                </apex:pageBlockSectionItem>
                            
                                <apex:pageBlockSectionItem rendered="{!NOT(mIsBatchJobSubmitted)}">
                                    <apex:outputLabel value="{!$ObjectType.Branch_Setup__c.Fields.Name.Label}"></apex:outputLabel>
                                    <apex:outputPanel>
                                        <apex:selectList value="{!mSelectedBranch}" multiselect="false" size="1" 
                                                         style="width: auto !important;">
                                            <apex:selectOptions value="{!mBranchSelectList}"/>
                                        </apex:selectList>
                                        <p class="slds-text-body_small slds-text-color_weak">{!$Label.fscore__batch_job_select_branch_help_text}"</p>
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem rendered="{!mIsBatchJobSubmitted}">
                                    <apex:outputLabel value="{!$ObjectType.Branch_Setup__c.Fields.Name.Label}"></apex:outputLabel>
                                    <apex:outputText value="{!mSelectedBranch}"></apex:outputText>
                                </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                        </div>
                    </apex:outputPanel>

                    <apex:pageBlockButtons style="float: right;" location="bottom" rendered="{!mIsBatchJobOrGroupSelected}">
                        <apex:commandButton styleClass="slds-button slds-button--brand" action="{!onSubmit}" status="waitStatus"
                                            title="{!$Label.fscore__submit_button_tooltip}" value="{!$Label.fscore__submit_button}"
                                            reRender="messagePanel,infoMessagePanel,blkSubmitBatchJob" rendered="{!NOT(mIsBatchJobSubmitted)}"/>
                                        
                        <apex:commandButton styleClass="slds-button slds-button--neutral" action="{!onCancel}" status="waitStatus"
                                            title="{!$Label.fscore__cancel_button_tooltip}" value="{!$Label.fscore__cancel_button}"
                                            reRender="messagePanel,infoMessagePanel,blkSubmitBatchJob" rendered="{!NOT(mIsBatchJobSubmitted)}"/>
                                            
                        <apex:commandButton styleClass="slds-button slds-button--neutral" action="{!onReset}" status="waitStatus"
                                            title="{!$Label.fscore__reset_button}" value="{!$Label.fscore__reset_button}"
                                            reRender="messagePanel,infoMessagePanel,blkSubmitBatchJob" rendered="{!mIsBatchJobSubmitted}"/>

                        <apex:commandButton styleClass="slds-button slds-button--neutral" action="{!onCancel}" status="waitStatus"
                                            title="{!$Label.fscore__clear_button}" value="{!$Label.fscore__clear_button}"
                                            reRender="messagePanel,infoMessagePanel,blkSubmitBatchJob" rendered="{!mIsBatchJobSubmitted}"/>
                    </apex:pageBlockButtons>
                </apex:pageBlock>
            </div>
        </apex:form>
    </div>
</apex:page>
